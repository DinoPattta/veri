â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘  VERIFICADOR DE SEGURIDAD WINDOWS - ISO 27001/27002                       â•‘
â•‘  VERSIÃ“N 3.0 - CAMBIOS Y MEJORAS DETALLADAS                               â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“Š RESUMEN DE CAMBIOS V3.0

De v2.1 a v3.0 se han implementado mejoras MASIVAS en granularidad y detalle:

VersiÃ³n 2.1:  11 controles totales    â†’ PuntuaciÃ³n ISO de 4 normas
VersiÃ³n 3.0:  30 controles totales    â†’ AnÃ¡lisis detallado por componente

## ğŸ” EXPANSIÃ“N DE CONTROLES POR MÃ“DULO

### 1. VERIFICADOR DE CONTRASEÃ‘AS (ISO/IEC 27001 A.9.2)
   Controles en v2.1:  1
   Controles en v3.0:  6

   NUEVOS CONTROLES AÃ‘ADIDOS:
   âœ“ Longitud mÃ­nima (â‰¥12 caracteres)
   âœ“ Complejidad requerida
   âœ“ Caducidad (â‰¤90 dÃ­as)
   âœ“ Historial de contraseÃ±as (â‰¥24)
   âœ“ Bloqueo por intentos fallidos (â‰¥5)
   âœ“ DuraciÃ³n de bloqueo (â‰¥30 minutos)

   VERIFICACIONES DETALLADAS:
   - Lee directamente: net accounts
   - Valida CADA parÃ¡metro contra ISO 27001 A.9.2
   - Genera recomendaciones especÃ­ficas de comando PowerShell
   - Calcula estado de cumplimiento individual

### 2. VERIFICADOR DE ACTUALIZACIONES (ISO/IEC 27001 A.12.6)
   Controles en v2.1:  1
   Controles en v3.0:  4

   NUEVOS CONTROLES AÃ‘ADIDOS:
   âœ“ Windows Update automÃ¡tico
   âœ“ Servicio WuAuServ en ejecuciÃ³n
   âœ“ Ãšltima actualizaciÃ³n (â‰¤30 dÃ­as)
   âœ“ KB crÃ­ticos pendientes

   VERIFICACIONES DETALLADAS:
   - Consulta estado del servicio WuAuServ
   - Verifica fecha de Ãºltima actualizaciÃ³n con cÃ¡lculo de dÃ­as
   - Detecta actualizaciones pendientes crÃ­ticas
   - Recomendaciones especÃ­ficas de Windows Update

### 3. VERIFICADOR DE FIREWALL (ISO/IEC 27001 A.13.1)
   Controles en v2.1:  1
   Controles en v3.0:  4

   NUEVOS CONTROLES AÃ‘ADIDOS:
   âœ“ Firewall habilitado (Perfil Dominio)
   âœ“ Firewall habilitado (Perfil Privado)
   âœ“ Firewall habilitado (Perfil PÃºblico)
   âœ“ Notificaciones habilitadas

   VERIFICACIONES DETALLADAS:
   - Verifica CADA perfil por separado (Dominio/Privado/PÃºblico)
   - Detecta deshabilitar parcial de firewall
   - Valida notificaciones de bloqueo
   - Comandos netsh especÃ­ficos por perfil

### 4. VERIFICADOR DE ANTIMALWARE (ISO/IEC 27001 A.12.2)
   Controles en v2.1:  1
   Controles en v3.0:  4

   NUEVOS CONTROLES AÃ‘ADIDOS:
   âœ“ Windows Defender habilitado
   âœ“ ProtecciÃ³n en tiempo real
   âœ“ Definiciones actualizadas
   âœ“ AnÃ¡lisis programado

   VERIFICACIONES DETALLADAS:
   - Get-MpComputerStatus para estado Defender
   - Verifica protecciÃ³n real-time especÃ­ficamente
   - Fecha de actualizaciÃ³n de definiciones
   - Ãšltima exploraciÃ³n ejecutada

### 5. VERIFICADOR DE AUDITORÃA (ISO/IEC 27001 A.12.4)
   Controles en v2.1:  1
   Controles en v3.0:  4

   NUEVOS CONTROLES AÃ‘ADIDOS:
   âœ“ Registro de seguridad habilitado
   âœ“ AuditorÃ­a de logon habilitada
   âœ“ TamaÃ±o de logs adecuado (â‰¥512MB)
   âœ“ RetenciÃ³n de logs (â‰¥30 dÃ­as)

   VERIFICACIONES DETALLADAS:
   - wevtutil para estado del registro de seguridad
   - Calcula tamaÃ±o actual en MB (â‰¥512 recomendado)
   - Verifica polÃ­ticas de auditorÃ­a especÃ­ficas
   - RetenciÃ³n configurada en dÃ­as

### 6. VERIFICADOR DE USUARIOS (ISO/IEC 27001 A.9.1)
   Controles en v2.1:  1
   Controles en v3.0:  5

   NUEVOS CONTROLES AÃ‘ADIDOS:
   âœ“ Cuenta Guest deshabilitada
   âœ“ Cuenta Administrator renombrada
   âœ“ Cuentas de servicio sin uso
   âœ“ Cuentas administrativas limitadas
   âœ“ UAC habilitado

   VERIFICACIONES DETALLADAS:
   - net user Guest para estado
   - Verifica nombre de Administrator
   - Identifica cuentas de servicio
   - Cuenta total de administradores
   - Estado de UAC (User Account Control)

### 7. VERIFICADOR DE ENCRIPTACIÃ“N (ISO/IEC 27001 A.10.2)
   Controles en v2.1:  1
   Controles en v3.0:  3

   NUEVOS CONTROLES AÃ‘ADIDOS:
   âœ“ BitLocker habilitado (C:)
   âœ“ Sistema de archivos NTFS
   âœ“ EncriptaciÃ³n de datos en trÃ¡nsito

   VERIFICACIONES DETALLADAS:
   - Detecta BitLocker por volumen
   - wmic logicaldisk para filesystem
   - Valida NTFS vs FAT/FAT32
   - Recomendaciones de cifrado de datos

## ğŸ“ˆ RESULTADOS AGREGADOS

TOTAL DE CONTROLES: 30
MAPEO ISO: 4 normas (A.9, A.10, A.12, A.13)

Desglose por Norma:
  ISO/IEC 27001 A.9:  11 controles (GestiÃ³n de acceso y contraseÃ±as)
  ISO/IEC 27001 A.10:  3 controles (CriptografÃ­a)
  ISO/IEC 27001 A.12: 12 controles (Operaciones de seguridad)
  ISO/IEC 27001 A.13:  4 controles (Comunicaciones)

## ğŸ’¡ MEJORAS EN REPORTES

### FORMATO JSON (reporte_seguridad.json)
  âœ“ Estructura completa por control
  âœ“ Detalles individuales de cada verificaciÃ³n
  âœ“ Comandos recomendados especÃ­ficos
  âœ“ Mapeo directo a norma ISO
  âœ“ Puntuaciones granulares por ISO

  Ejemplo de estructura:
  {
    "fecha": "2025-11-30T23:46:57.432418",
    "puntuacion_general": 16,
    "controles_cumplidos": "5/30",
    "puntuaciones_iso": {
      "ISO/IEC 27001 A.9": {
        "cumplidos": 0,
        "total": 11,
        "porcentaje": 0
      },
      ...
    },
    "verificaciones": { ... detalle completo ... },
    "hallazgos": [ ... con severidad y recomendaciones ... ]
  }

### FORMATO HTML (reporte_seguridad.html)
  âœ“ Interfaz visual mejorada
  âœ“ GrÃ¡ficos de progreso por ISO
  âœ“ CÃ³digo de colores por severidad
  âœ“ Listado detallado de hallazgos
  âœ“ Recomendaciones ejecutables

## ğŸ¯ MAPEO DETALLADO A ISO 27001:2022

A.9.2 GESTIÃ“N DE CREDENCIALES
  â””â”€ 6 controles especÃ­ficos de contraseÃ±as
  â””â”€ Cumplimiento: Longitud, complejidad, caducidad, historial, bloqueo

A.9.1 GESTIÃ“N DE ACCESO
  â””â”€ 5 controles de usuarios y cuentas
  â””â”€ Cumplimiento: Guest, Admin, UAC, cuentas activas

A.10.2 CRIPTOGRAFÃA
  â””â”€ 3 controles de encriptaciÃ³n
  â””â”€ Cumplimiento: BitLocker, NTFS, encriptaciÃ³n en trÃ¡nsito

A.12.2 PROTECCIÃ“N CONTRA MALWARE
  â””â”€ 4 controles de antimalware
  â””â”€ Cumplimiento: Defender, tiempo real, definiciones, anÃ¡lisis

A.12.4 REGISTROS Y AUDITORÃA
  â””â”€ 4 controles de auditorÃ­a
  â””â”€ Cumplimiento: Logs, auditorÃ­a de logon, tamaÃ±o, retenciÃ³n

A.12.6 GESTIÃ“N DE VULNERABILIDADES
  â””â”€ 4 controles de actualizaciones
  â””â”€ Cumplimiento: Windows Update, KB, Ãºltimas actualizaciones

A.13.1 PERÃMETRO DE SEGURIDAD
  â””â”€ 4 controles de firewall
  â””â”€ Cumplimiento: Perfiles, polÃ­ticas, notificaciones

## ğŸ”§ COMANDOS RECOMENDADOS POR DEFICIENCIA

CONTRASEÃ‘AS:
  net accounts /minpwlen:12              â†’ Longitud mÃ­nima
  net accounts /maxpwage:90              â†’ Caducidad
  net accounts /uniquepw:24              â†’ Historial
  net accounts /lockoutthreshold:5       â†’ Bloqueo por intentos
  net accounts /lockoutduration:30       â†’ DuraciÃ³n del bloqueo

FIREWALL:
  netsh advfirewall set allprofiles state on  â†’ Habilitar todos

ANTIMALWARE:
  powershell -c 'Set-MpPreference -DisableRealtimeMonitoring $false'

USUARIOS:
  net user Guest /active:no              â†’ Deshabilitar Guest

## ğŸ“Š EJEMPLO DE EJECUCIÃ“N V3.0

================================================================================
VERIFICADOR DE SEGURIDAD WINDOWS - ISO 27001/27002 v3.0 DETALLADO
================================================================================

[*] PolÃ­ticas de ContraseÃ±as... âœ— (NO_CUMPLE)
[*] Actualizaciones y Parches... âœ— (NO_CUMPLE)
[*] Firewall... âœ— (NO_CUMPLE)
[*] Antimalware... âœ“ (CUMPLE)
[*] AuditorÃ­a y Registros... âœ— (NO_CUMPLE)
[*] Usuarios y Cuentas... âœ— (NO_CUMPLE)
[*] EncriptaciÃ³n... âœ— (NO_CUMPLE)

[*] Generando reportes...
    âœ“ reporte_seguridad.json
    âœ“ reporte_seguridad.html

================================================================================
PuntuaciÃ³n General: 16%
Controles Cumplidos: 5/30

Puntuaciones por Norma ISO:
  ISO/IEC 27001 A.9: 0% (0/11)
  ISO/IEC 27001 A.10: 0% (0/3)
  ISO/IEC 27001 A.12: 25% (3/12)
  ISO/IEC 27001 A.13: 50% (2/4)

Total de Hallazgos: 11
================================================================================

## ğŸš€ PRÃ“XIMAS MEJORAS PLANEADAS

v3.1:
  âœ“ Implementar bitlocker check
  âœ“ Validar fecha de Ãºltima exploraciÃ³n Defender
  âœ“ AÃ±adir mÃ¡s comandos PowerShell especÃ­ficos
  âœ“ Exportar en formato CSV adicional

v3.2:
  âœ“ Base de datos de cumplimiento histÃ³rico
  âœ“ GrÃ¡ficos de tendencia temporal
  âœ“ Comparativa con sistemas similares
  âœ“ Benchmark contra estÃ¡ndares NIST

## ğŸ“ NOTAS TÃ‰CNICAS

- Compatibilidad: Windows 10/11, Server 2016+
- Python: 3.7+
- Ejecutor: EJECUTAR.bat (con validaciÃ³n de admin)
- Reportes: JSON + HTML interactivo
- Actualizaciones: v3.0 en commit 5d9caf7

## âœ… VALIDACIÃ“N

Ejecutar programa con:
  python veri.py
  o
  EJECUTAR.bat (recomendado)

Esperar outputs:
  - reporte_seguridad.json (398 lÃ­neas en v3.0)
  - reporte_seguridad.html (visual interactivo)
  - Resumen en terminal con puntuaciones ISO

